{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://osnmalib.eu/status_log.schema.json",
  "title": "OSNMAlib Status Log",
  "description": "Format of the JSON status log generated by OSNMAlib",

  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "metadata": {
        "description": "General information related to the subframe",
        "type": "object",
        "properties": {
          "GST_subframe": {
            "description": "Galileo Satellite Time at the start of the reception of the subframe",
            "type": "array",
            "items": {
              "type": "integer"
            }
          },
          "input_module": {
            "description": "OSNMAlib input module used to receive the navigation data",
            "type": "string"
          },
          "OSNMAlib_status": {
            "description": "Status of OSNMAlib as a library regarding the possession of cryptographic material.",
            "type": "string",
            "enum": [
              "COLD_START",
              "WARM_START",
              "HOT_START",
              "STARTED",
              "OSNMA_AM"
            ]
          }
        }
      },
      "OSNMA_status": {
        "description": "Information on the last authenticated status of OSNMA",
        "type": "object",
        "properties": {
          "nma_status": {
            "type": "object",
            "properties": {
              "nmas": {
                "description": "OSNMA status",
                "type": [
                  "string",
                  "null"
                ],
                "enum": [
                  "TEST",
                  "OPERATIONAL",
                  "DONT_USE",
                  null
                ]
              },
              "cid": {
                "description": "ID of the TESLA chain in force",
                "type": [
                  "integer",
                  "null"
                ]
              },
              "cpks": {
                "description": "Chain and public key status",
                "type": [
                  "string",
                  "null"
                ],
                "enum": [
                  "NOMINAL",
                  "EOC",
                  "CREV",
                  "NPK",
                  "PKREV",
                  "NMT",
                  "AM",
                  null
                ]
              }
            }
          },
          "tesla_chain_in_force": {
            "type": [
              "object",
              "null"
            ],
            "properties": {
              "pkid": {
                "type": "integer"
              },
              "cidkr": {
                "type": "integer"
              },
              "hf": {
                "type": "string",
                "enum": [
                  "SHA_256",
                  "SHA3_224",
                  "SHA3_256"
                ]
              },
              "mf": {
                "type": "string",
                "enum": [
                  "HMAC_SHA_256",
                  "CMAC_AES"
                ]
              },
              "ks": {
                "type": "integer"
              },
              "ts": {
                "type": "integer"
              },
              "maclt": {
                "type": "integer"
              },
              "maclt_sequence": {
                "type": "array"
              }
            }
          },
          "public_key_in_force": {
            "type": [
              "object",
              "null"
            ],
            "properties": {
              "npkid": {
                "type": "integer"
              },
              "npkt": {
                "type": "string",
                "enum": [
                  "ECDSA_P256",
                  "ECDSA_P521",
                  "OAM"
                ]
              },
              "mid": {
                "type": "integer"
              }
            }
          }
        }
      },
      "OSNMA_material_received": {
        "description": "OSNMA material received from each satellite transmitting OSNMA",
        "type": "object",
        "patternProperties": {
          "^[0-9]+$": {
            "type": "object",
            "properties": {
              "hkroot_data": {
                "type": "object",
                "properties": {
                  "nma_header": {
                    "type": [
                      "object",
                      "null"
                    ],
                    "properties": {
                      "nmas": {
                        "description": "OSNMA status",
                        "type": "string",
                        "enum": [
                          "TEST",
                          "OPERATIONAL",
                          "DONT_USE"
                        ]
                      },
                      "cid": {
                        "description": "ID of the TESLA chain in force",
                        "type": "integer"
                      },
                      "cpks": {
                        "description": "Chain and public key status",
                        "type": "string",
                        "enum": [
                          "NOMINAL",
                          "EOC",
                          "CREV",
                          "NPK",
                          "PKREV",
                          "NMT",
                          "AM"
                        ]
                      }
                    }
                  },
                  "dsm_header": {
                    "type": [
                      "object",
                      "null"
                    ],
                    "properties": {
                      "dsm_id": {
                        "type": "integer"
                      },
                      "block_id": {
                        "type": "integer"
                      }
                    }
                  },
                  "dsm_blocks": {
                    "type": "array",
                    "items": {
                      "type": "boolean"
                    }
                  }
                }
              },
              "mack_data": {
                "type": "object",
                "properties": {
                  "tesla_key": {
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "tags": {
                    "type": "array",
                    "maxItems": 10,
                    "items": {
                      "type": ["array", "null"],
                      "minItems": 3,
                      "maxItems": 4,
                      "items": [
                        {
                          "type": "integer"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "string"
                        }
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      },
      "nav_data_received": {
        "description": "OSNMA relevant navigation data received during this subframe for the tracked satellites",
        "type": "object",
        "patternProperties": {
          "^[0-9]+$": {
            "type": "object",
            "properties": {
              "ADKD0": {
                "type": "object",
                "properties": {
                  "1": {
                    "type": "boolean"
                  },
                  "2": {
                    "type": "boolean"
                  },
                  "3": {
                    "type": "boolean"
                  },
                  "4": {
                    "type": "boolean"
                  },
                  "5": {
                    "type": "boolean"
                  }
                }
              },
              "ADKD4": {
                "type": "object",
                "properties": {
                  "6": {
                    "type": "boolean"
                  },
                  "10": {
                    "type": [
                      "boolean",
                      "null"
                    ]
                  }
                }
              }
            }
          }
        }
      },
      "verified_OSNMA_material": {
        "description": "Result of the OSNMA verification process",
        "type": "object",
        "properties": {
          "tela_key": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "svid": {
                  "type": "integer"
                },
                "verification": {
                  "type": "boolean"
                },
                "reconstructed": {
                  "type": "boolean"
                },
                "GST": {
                  "type": "array",
                  "items": {
                    "type": "integer"
                  }
                }
              }
            }
          },
          "macseq": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "prn_a": {
                  "type": "integer"
                },
                "verification": {
                  "type": "boolean"
                },
                "GST": {
                  "type": "array",
                  "items": {
                    "type": "integer"
                  }
                },
                "flex_tags": {
                  "type": "array",
                  "maxItems": 4,
                  "items": {
                    "type": "array",
                    "minItems": 3,
                    "maxItems": 4,
                    "items": [
                      {
                        "type": "integer"
                      },
                      {
                        "type": "integer"
                      },
                      {
                        "type": "integer"
                      },
                      {
                        "type": "string"
                      }
                    ]
                  }
                }
              }
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "prn_a": {
                  "type": "integer"
                },
                "prn_d": {
                  "type": "integer"
                },
                "adkd": {
                  "type": "integer"
                },
                "cop": {
                  "type": "integer"
                },
                "flx": {
                  "type": "boolean"
                },
                "GST": {
                  "type": "array",
                  "items": {
                    "type": "integer"
                  }
                }
              }
            }
          },
          "last_kroot": {
            "type": [
              "object",
              "null"
            ]
          },
          "last_pkr": {
            "type": [
              "object",
              "null"
            ]
          }
        }
      },
      "authenticated_nav_data": {
        "description": "Authenticated navigation data by using the OSNMA tags",
        "type": "object",
        "properties": {
          "ADKD0": {
            "type": "object",
            "patternProperties": {
              "^[0-9]+$": {
                "type": "object",
                "properties": {
                  "iod": {
                    "type": "string"
                  },
                  "acc_length": {
                    "type": "integer"
                  },
                  "start_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  },
                  "last_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "ADKD4": {
            "type": "object",
            "patternProperties": {
              "^[0-9]+$": {
                "type": "object",
                "properties": {
                  "iod": {
                    "type": "null"
                  },
                  "acc_length": {
                    "type": "integer"
                  },
                  "start_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  },
                  "last_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          },
          "ADKD12": {
            "type": "object",
            "patternProperties": {
              "^[0-9]+$": {
                "type": "object",
                "properties": {
                  "iod": {
                    "type": "string"
                  },
                  "acc_length": {
                    "type": "integer"
                  },
                  "start_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  },
                  "last_gst": {
                    "type": "array",
                    "items": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}




















